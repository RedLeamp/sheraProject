<Window x:Class="OfficeManagerWPF.MainWindow"
        xmlns="http://schemas.microsoft.com/winfx/2006/xaml/presentation"
        xmlns:x="http://schemas.microsoft.com/winfx/2006/xaml"
        xmlns:local="clr-namespace:OfficeManagerWPF.ViewModels"
        Title="Office Manager - ê³µìœ ì˜¤í”¼ìŠ¤ ê´€ë¦¬ ì‹œìŠ¤í…œ" 
        Height="800" Width="1400"
        WindowStartupLocation="CenterScreen"
        Background="#1E1E1E"
        Icon="pack://application:,,,/Resources/app.ico">
    
    <Window.DataContext>
        <local:MainViewModel/>
    </Window.DataContext>

    <Window.Resources>
        <!-- Visual Studio Dark Theme ìƒ‰ìƒ -->
        <SolidColorBrush x:Key="VSDarkBg" Color="#1E1E1E"/>
        <SolidColorBrush x:Key="VSLightBg" Color="#2D2D30"/>
        <SolidColorBrush x:Key="VSAccent" Color="#007ACC"/>
        <SolidColorBrush x:Key="VSTextPrimary" Color="#FFFFFF"/>
        <SolidColorBrush x:Key="VSTextSecondary" Color="#CCCCCC"/>
        <SolidColorBrush x:Key="VSBorder" Color="#3F3F46"/>
        <SolidColorBrush x:Key="VSHover" Color="#3E3E40"/>

        <!-- ë²„íŠ¼ ìŠ¤íƒ€ì¼ -->
        <Style x:Key="VSButton" TargetType="Button">
            <Setter Property="Background" Value="{StaticResource VSLightBg}"/>
            <Setter Property="Foreground" Value="{StaticResource VSTextPrimary}"/>
            <Setter Property="BorderBrush" Value="{StaticResource VSBorder}"/>
            <Setter Property="BorderThickness" Value="1"/>
            <Setter Property="Padding" Value="15,8"/>
            <Setter Property="FontSize" Value="13"/>
            <Setter Property="Cursor" Value="Hand"/>
            <Setter Property="Template">
                <Setter.Value>
                    <ControlTemplate TargetType="Button">
                        <Border Background="{TemplateBinding Background}"
                                BorderBrush="{TemplateBinding BorderBrush}"
                                BorderThickness="{TemplateBinding BorderThickness}">
                            <ContentPresenter HorizontalAlignment="Center" VerticalAlignment="Center"
                                            Margin="{TemplateBinding Padding}"/>
                        </Border>
                    </ControlTemplate>
                </Setter.Value>
            </Setter>
            <Style.Triggers>
                <Trigger Property="IsMouseOver" Value="True">
                    <Setter Property="Background" Value="{StaticResource VSHover}"/>
                </Trigger>
            </Style.Triggers>
        </Style>

        <!-- ì•¡ì„¼íŠ¸ ë²„íŠ¼ -->
        <Style x:Key="VSAccentButton" TargetType="Button" BasedOn="{StaticResource VSButton}">
            <Setter Property="Background" Value="{StaticResource VSAccent}"/>
            <Style.Triggers>
                <Trigger Property="IsMouseOver" Value="True">
                    <Setter Property="Background" Value="#005A9E"/>
                </Trigger>
            </Style.Triggers>
        </Style>
    </Window.Resources>

    <Grid>
        <Grid.ColumnDefinitions>
            <ColumnDefinition Width="250"/>
            <ColumnDefinition Width="*"/>
        </Grid.ColumnDefinitions>

        <!-- ì™¼ìª½ ì‚¬ì´ë“œë°” (VS ìŠ¤íƒ€ì¼) -->
        <Border Grid.Column="0" Background="{StaticResource VSLightBg}" BorderBrush="{StaticResource VSBorder}" BorderThickness="0,0,1,0">
            <StackPanel>
                <!-- ë¡œê³  ë° íƒ€ì´í‹€ -->
                <Border Background="{StaticResource VSAccent}" Padding="20,15">
                    <StackPanel>
                        <TextBlock Text="OFFICE MANAGER" 
                                   Foreground="White" 
                                   FontSize="14" 
                                   FontWeight="Bold"/>
                        <TextBlock Text="ê³µìœ ì˜¤í”¼ìŠ¤ ê´€ë¦¬" 
                                   Foreground="#E0E0E0" 
                                   FontSize="11"
                                   Margin="0,3,0,0"/>
                    </StackPanel>
                </Border>

                <!-- ë©”ë‰´ í•­ëª© -->
                <StackPanel Margin="0,10,0,0">
                    <!-- ëŒ€ì‹œë³´ë“œ -->
                    <Button Style="{StaticResource VSButton}" 
                            Padding="20,12"
                            HorizontalContentAlignment="Left"
                            BorderThickness="0"
                            Background="#2D2D30">
                        <StackPanel Orientation="Horizontal">
                            <TextBlock Text="ðŸ“Š" FontSize="16" Margin="0,0,10,0"/>
                            <TextBlock Text="ëŒ€ì‹œë³´ë“œ" FontSize="13"/>
                        </StackPanel>
                    </Button>

                    <Separator Background="{StaticResource VSBorder}" Margin="15,5"/>

                    <!-- ì—…ì²´ ê´€ë¦¬ -->
                    <Button Style="{StaticResource VSButton}" 
                            Command="{Binding OpenCompanyManagementCommand}"
                            Padding="20,12"
                            HorizontalContentAlignment="Left"
                            BorderThickness="0">
                        <StackPanel Orientation="Horizontal">
                            <TextBlock Text="ðŸ¢" FontSize="16" Margin="0,0,10,0"/>
                            <TextBlock Text="ì—…ì²´ ê´€ë¦¬" FontSize="13"/>
                        </StackPanel>
                    </Button>

                    <!-- ìž…ê¸ˆ/ì§€ì¶œ -->
                    <Button Style="{StaticResource VSButton}" 
                            Command="{Binding OpenPaymentExpenseCommand}"
                            Padding="20,12"
                            HorizontalContentAlignment="Left"
                            BorderThickness="0">
                        <StackPanel Orientation="Horizontal">
                            <TextBlock Text="ðŸ’°" FontSize="16" Margin="0,0,10,0"/>
                            <TextBlock Text="ìž…ê¸ˆ/ì§€ì¶œ ê´€ë¦¬" FontSize="13"/>
                        </StackPanel>
                    </Button>

                    <!-- ë¯¸ìˆ˜ê¸ˆ -->
                    <Button Style="{StaticResource VSButton}" 
                            Command="{Binding OpenUnpaidManagementCommand}"
                            Padding="20,12"
                            HorizontalContentAlignment="Left"
                            BorderThickness="0">
                        <StackPanel Orientation="Horizontal">
                            <TextBlock Text="âš ï¸" FontSize="16" Margin="0,0,10,0"/>
                            <TextBlock Text="ë¯¸ìˆ˜ê¸ˆ ê´€ë¦¬" FontSize="13"/>
                        </StackPanel>
                    </Button>

                    <Separator Background="{StaticResource VSBorder}" Margin="15,5"/>

                    <!-- ì•Œë¦¼ ì„¤ì • -->
                    <Button Style="{StaticResource VSButton}" 
                            Command="{Binding OpenNotificationSettingsCommand}"
                            Padding="20,12"
                            HorizontalContentAlignment="Left"
                            BorderThickness="0">
                        <StackPanel Orientation="Horizontal">
                            <TextBlock Text="ðŸ””" FontSize="16" Margin="0,0,10,0"/>
                            <TextBlock Text="ì•Œë¦¼ ì„¤ì •" FontSize="13"/>
                        </StackPanel>
                    </Button>

                    <!-- ì•Œë¦¼ ë‚´ì—­ -->
                    <Button Style="{StaticResource VSButton}" 
                            Command="{Binding OpenNotificationLogsCommand}"
                            Padding="20,12"
                            HorizontalContentAlignment="Left"
                            BorderThickness="0">
                        <StackPanel Orientation="Horizontal">
                            <TextBlock Text="ðŸ“‹" FontSize="16" Margin="0,0,10,0"/>
                            <TextBlock Text="ì•Œë¦¼ ë‚´ì—­" FontSize="13"/>
                        </StackPanel>
                    </Button>
                </StackPanel>
            </StackPanel>
        </Border>

        <!-- ë©”ì¸ ì»¨í…ì¸  ì˜ì—­ -->
        <Grid Grid.Column="1" Background="{StaticResource VSDarkBg}">
            <ScrollViewer VerticalScrollBarVisibility="Auto">
                <StackPanel Margin="30">
                    <!-- í—¤ë” -->
                    <Grid Margin="0,0,0,25">
                        <StackPanel>
                            <TextBlock Text="DASHBOARD" 
                                       Foreground="{StaticResource VSTextPrimary}" 
                                       FontSize="24" 
                                       FontWeight="Light"/>
                            <TextBlock Text="{Binding SelectedPeriod, StringFormat={}{0}}" 
                                       Foreground="{StaticResource VSTextSecondary}" 
                                       FontSize="13"
                                       Margin="0,5,0,0"/>
                        </StackPanel>
                    </Grid>

                    <!-- í†µê³„ ì¹´ë“œ ê·¸ë¦¬ë“œ -->
                    <Grid Margin="0,0,0,25">
                        <Grid.ColumnDefinitions>
                            <ColumnDefinition Width="*"/>
                            <ColumnDefinition Width="15"/>
                            <ColumnDefinition Width="*"/>
                            <ColumnDefinition Width="15"/>
                            <ColumnDefinition Width="*"/>
                        </Grid.ColumnDefinitions>

                        <!-- ì´ ìž…ê¸ˆì•¡ -->
                        <Border Grid.Column="0" Background="{StaticResource VSLightBg}" 
                                BorderBrush="{StaticResource VSBorder}" BorderThickness="1" Padding="20">
                            <StackPanel>
                                <TextBlock Text="ì´ ìž…ê¸ˆì•¡" 
                                           Foreground="{StaticResource VSTextSecondary}" 
                                           FontSize="12"/>
                                <TextBlock Text="{Binding TotalPayments, StringFormat={}{0:N0}ì›}" 
                                           Foreground="#4EC9B0" 
                                           FontSize="28" 
                                           FontWeight="Bold"
                                           Margin="0,8,0,0"/>
                                <TextBlock Text="â†‘ Income" 
                                           Foreground="#4EC9B0" 
                                           FontSize="11"
                                           Margin="0,5,0,0"/>
                            </StackPanel>
                        </Border>

                        <!-- ì´ ì§€ì¶œì•¡ -->
                        <Border Grid.Column="2" Background="{StaticResource VSLightBg}" 
                                BorderBrush="{StaticResource VSBorder}" BorderThickness="1" Padding="20">
                            <StackPanel>
                                <TextBlock Text="ì´ ì§€ì¶œì•¡" 
                                           Foreground="{StaticResource VSTextSecondary}" 
                                           FontSize="12"/>
                                <TextBlock Text="{Binding TotalExpenses, StringFormat={}{0:N0}ì›}" 
                                           Foreground="#F48771" 
                                           FontSize="28" 
                                           FontWeight="Bold"
                                           Margin="0,8,0,0"/>
                                <TextBlock Text="â†“ Expense" 
                                           Foreground="#F48771" 
                                           FontSize="11"
                                           Margin="0,5,0,0"/>
                            </StackPanel>
                        </Border>

                        <!-- ìˆœì´ìµ -->
                        <Border Grid.Column="4" Background="{StaticResource VSLightBg}" 
                                BorderBrush="{StaticResource VSBorder}" BorderThickness="1" Padding="20">
                            <StackPanel>
                                <TextBlock Text="ìˆœì´ìµ" 
                                           Foreground="{StaticResource VSTextSecondary}" 
                                           FontSize="12"/>
                                <TextBlock Text="{Binding NetProfit, StringFormat={}{0:N0}ì›}" 
                                           Foreground="#569CD6" 
                                           FontSize="28" 
                                           FontWeight="Bold"
                                           Margin="0,8,0,0"/>
                                <TextBlock Text="= Net Profit" 
                                           Foreground="#569CD6" 
                                           FontSize="11"
                                           Margin="0,5,0,0"/>
                            </StackPanel>
                        </Border>
                    </Grid>

                    <!-- ë¹ ë¥¸ ì •ë³´ -->
                    <Grid Margin="0,0,0,25">
                        <Grid.ColumnDefinitions>
                            <ColumnDefinition Width="*"/>
                            <ColumnDefinition Width="15"/>
                            <ColumnDefinition Width="*"/>
                        </Grid.ColumnDefinitions>

                        <Border Grid.Column="0" Background="{StaticResource VSLightBg}" 
                                BorderBrush="{StaticResource VSBorder}" BorderThickness="1" Padding="20">
                            <StackPanel>
                                <TextBlock Text="ACTIVE COMPANIES" 
                                           Foreground="{StaticResource VSTextSecondary}" 
                                           FontSize="11"/>
                                <TextBlock Text="{Binding ActiveCompanies, StringFormat={}{0}}" 
                                           Foreground="{StaticResource VSTextPrimary}" 
                                           FontSize="36" 
                                           FontWeight="Bold"
                                           Margin="0,8,0,0"/>
                                <TextBlock Text="ê°œ ì—…ì²´" 
                                           Foreground="{StaticResource VSTextSecondary}" 
                                           FontSize="12"
                                           Margin="0,5,0,0"/>
                            </StackPanel>
                        </Border>

                        <Border Grid.Column="2" Background="{StaticResource VSLightBg}" 
                                BorderBrush="#DC3545" BorderThickness="2" Padding="20">
                            <StackPanel>
                                <TextBlock Text="UNPAID ACCOUNTS" 
                                           Foreground="{StaticResource VSTextSecondary}" 
                                           FontSize="11"/>
                                <TextBlock Text="{Binding UnpaidCount, StringFormat={}{0}}" 
                                           Foreground="#DC3545" 
                                           FontSize="36" 
                                           FontWeight="Bold"
                                           Margin="0,8,0,0"/>
                                <TextBlock Text="ê±´ ë¯¸ìˆ˜ê¸ˆ" 
                                           Foreground="#DC3545" 
                                           FontSize="12"
                                           Margin="0,5,0,0"/>
                            </StackPanel>
                        </Border>
                    </Grid>

                    <!-- ì•ˆë‚´ í…ìŠ¤íŠ¸ -->
                    <Border Background="{StaticResource VSLightBg}" 
                            BorderBrush="{StaticResource VSAccent}" 
                            BorderThickness="2,0,0,0" 
                            Padding="15"
                            Margin="0,10,0,0">
                        <StackPanel>
                            <TextBlock Text="ðŸ’¡ ì‹œìŠ¤í…œ ì•ˆë‚´" 
                                       Foreground="{StaticResource VSTextPrimary}" 
                                       FontSize="13"
                                       FontWeight="SemiBold"/>
                            <TextBlock Text="â€¢ ë¯¸ìˆ˜ê¸ˆ ì•Œë¦¼: ì›”ì´ˆ(1-5ì¼), ì¤‘ìˆœ(13-17ì¼), ì›”ë§(25-30ì¼) ìžë™ ë°œì†¡" 
                                       Foreground="{StaticResource VSTextSecondary}" 
                                       FontSize="12"
                                       Margin="0,8,0,3"/>
                            <TextBlock Text="â€¢ ì›”ì„¸ ë‚©ë¶€ ì•Œë¦¼: 7ì¼ ì „, 3ì¼ ì „, ë‹¹ì¼ ìžë™ ë°œì†¡ (SMS + ì´ë©”ì¼)" 
                                       Foreground="{StaticResource VSTextSecondary}" 
                                       FontSize="12"
                                       Margin="0,0,0,3"/>
                            <TextBlock Text="â€¢ ì•Œë¦¼ ì„¤ì • ë©”ë‰´ì—ì„œ SMS/ì´ë©”ì¼ ì„¤ì •ì„ ì™„ë£Œí•´ì£¼ì„¸ìš”" 
                                       Foreground="#DCDCAA" 
                                       FontSize="12"
                                       Margin="0,0,0,0"/>
                        </StackPanel>
                    </Border>
                </StackPanel>
            </ScrollViewer>
        </Grid>
    </Grid>
</Window>
