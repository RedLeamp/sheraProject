<Window x:Class="OfficeManagerWPF.Views.PaymentExpenseWindow"
        xmlns="http://schemas.microsoft.com/winfx/2006/xaml/presentation"
        xmlns:x="http://schemas.microsoft.com/winfx/2006/xaml"
        Title="입금/지출 관리" 
        Height="650" Width="1000"
        WindowStartupLocation="CenterScreen"
        Background="#F5F5F5"
    
    <Grid Margin="20">
        <Grid.RowDefinitions>
            <RowDefinition Height="Auto"/>
            <RowDefinition Height="Auto"/>
            <RowDefinition Height="*"/>
            <RowDefinition Height="Auto"/>
        </Grid.RowDefinitions>

        <!-- 헤더 -->
        <StackPanel Grid.Row="0" Margin="0,0,0,20">
            <TextBlock Text="입금/지출 관리" FontSize="24" FontWeight="Light"/>
            <TextBlock x:Name="PeriodText" 
                       Text="2025년 02월" 
                       FontSize="16" 
                       Foreground="#999999"
                       Margin="0,5,0,0"/>
        </StackPanel>

        <!-- 탭 컨트롤 -->
        <TabControl Grid.Row="1" Grid.RowSpan="2" BorderThickness="0" Background="Transparent">
            <!-- 입금 내역 탭 -->
            <TabItem Header="입금 내역" FontSize="14">
                <Grid Margin="0,20,0,0">
                    <Grid.RowDefinitions>
                        <RowDefinition Height="Auto"/>
                        <RowDefinition Height="*"/>
                    </Grid.RowDefinitions>

                    <!-- 통계 -->
                    <Border Grid.Row="0" 
                            Background="#E8F5E9" 
                            CornerRadius="8" 
                            Padding="20"
                            Margin="0,0,0,20">
                        <Grid>
                            <TextBlock Text="총 입금액" FontSize="14" Foreground="#666666"/>
                            <TextBlock x:Name="TotalPaymentsText" 
                                       Text="0원" 
                                       FontSize="20" 
                                       FontWeight="Medium" 
                                       Foreground="#4CAF50"
                                       HorizontalAlignment="Right"/>
                        </Grid>
                    </Border>

                    <!-- 입금 리스트 -->
                    <DataGrid Grid.Row="1" 
                              x:Name="PaymentsDataGrid"
                              AutoGenerateColumns="False"
                              CanUserAddRows="False"
                              Background="White"
                              BorderBrush="#E0E0E0">
                        <DataGrid.Columns>
                            <DataGridTextColumn Header="업체명" Binding="{Binding CompanyName}" Width="*"/>
                            <DataGridTextColumn Header="입금일자" Binding="{Binding PaymentDate, StringFormat=yyyy-MM-dd}" Width="120"/>
                            <DataGridTextColumn Header="입금액" Binding="{Binding Amount, StringFormat=N0}" Width="120"/>
                            <DataGridTextColumn Header="결제방법" Binding="{Binding PaymentMethod}" Width="120"/>
                            <DataGridTextColumn Header="비고" Binding="{Binding Notes}" Width="*"/>
                        </DataGrid.Columns>
                    </DataGrid>
                </Grid>
            </TabItem>

            <!-- 지출 내역 탭 -->
            <TabItem Header="지출 내역" FontSize="14">
                <Grid Margin="0,20,0,0">
                    <Grid.RowDefinitions>
                        <RowDefinition Height="Auto"/>
                        <RowDefinition Height="*"/>
                    </Grid.RowDefinitions>

                    <!-- 통계 -->
                    <Border Grid.Row="0" 
                            Background="#FFEBEE" 
                            CornerRadius="8" 
                            Padding="20"
                            Margin="0,0,0,20">
                        <Grid>
                            <TextBlock Text="총 지출액" FontSize="14" Foreground="#666666"/>
                            <TextBlock x:Name="TotalExpensesText" 
                                       Text="0원" 
                                       FontSize="20" 
                                       FontWeight="Medium" 
                                       Foreground="#F44336"
                                       HorizontalAlignment="Right"/>
                        </Grid>
                    </Border>

                    <!-- 지출 리스트 -->
                    <DataGrid Grid.Row="1" 
                              x:Name="ExpensesDataGrid"
                              AutoGenerateColumns="False"
                              CanUserAddRows="False"
                              Background="White"
                              BorderBrush="#E0E0E0">
                        <DataGrid.Columns>
                            <DataGridTextColumn Header="카테고리" Binding="{Binding Category}" Width="120"/>
                            <DataGridTextColumn Header="상세설명" Binding="{Binding Description}" Width="*"/>
                            <DataGridTextColumn Header="지출일자" Binding="{Binding ExpenseDate, StringFormat=yyyy-MM-dd}" Width="120"/>
                            <DataGridTextColumn Header="금액" Binding="{Binding Amount, StringFormat=N0}" Width="120"/>
                            <DataGridTextColumn Header="비고" Binding="{Binding Notes}" Width="*"/>
                        </DataGrid.Columns>
                    </DataGrid>
                </Grid>
            </TabItem>
        </TabControl>

        <!-- 하단 버튼 -->
        <StackPanel Grid.Row="3" Orientation="Horizontal" HorizontalAlignment="Right" Margin="0,20,0,0">
            <Button Content="Excel 내보내기" 
                    Padding="20,10" 
                    Background="#333333"
                    Foreground="White"
                    BorderThickness="0"
                    Cursor="Hand"
                    Click="ExportExcel_Click"/>
            <Button Content="Excel 가져오기" 
                    Padding="20,10" 
                    Margin="10,0,0,0"
                    Background="White"
                    BorderBrush="#E0E0E0"
                    Cursor="Hand"
                    Click="ImportExcel_Click"/>
            <Button Content="닫기" 
                    Padding="20,10" 
                    Margin="10,0,0,0"
                    Background="White"
                    BorderBrush="#E0E0E0"
                    Cursor="Hand"
                    Click="CloseButton_Click"/>
        </StackPanel>
    </Grid>
</Window>
